<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traffic & Deployment | K8s Resiliency Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 400px; max-height: 50vh; }
        .nav-link.active-page { background-color: #E0E7FF; color: #3730A3; font-weight: 600; }
        .strategy-checkbox:checked + label { background-color: #4338CA; color: white; border-color: #4338CA; }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <div class="flex">
        <aside class="sticky top-0 h-screen w-64 bg-white shadow-md p-4 hidden lg:block overflow-y-auto">
            <h2 class="text-xl font-bold text-indigo-800 mb-6">Resiliency Blueprints</h2>
            <nav id="main-nav" class="space-y-2">
                <div>
                    <h3 class="text-xs uppercase text-stone-500 font-semibold mb-2">Core Resilience</h3>
                    <a href="index.html" class="nav-link block w-full text-left p-2 rounded-md text-stone-600 hover:bg-stone-100 transition-colors">Fault Tolerance & Isolation</a>
                </div>
                <div>
                    <h3 class="text-xs uppercase text-stone-500 font-semibold mt-4 mb-2">Scaling & Availability</h3>
                    <a href="scaling.html" class="nav-link block w-full text-left p-2 rounded-md text-stone-600 hover:bg-stone-100 transition-colors">Horizontal & Cross-Cluster</a>
                </div>
                <div>
                    <h3 class="text-xs uppercase text-stone-500 font-semibold mt-4 mb-2">Traffic & Deployment</h3>
                    <a href="traffic.html" class="nav-link active-page block w-full text-left p-2 rounded-md text-stone-600 hover:bg-stone-100 transition-colors">Routing & Deployments</a>
                </div>
                <div>
                    <h3 class="text-xs uppercase text-stone-500 font-semibold mt-4 mb-2">Validation</h3>
                    <a href="validation.html" class="nav-link block w-full text-left p-2 rounded-md text-stone-600 hover:bg-stone-100 transition-colors">Benchmarking & Chaos</a>
                </div>
            </nav>
        </aside>

        <main class="w-full p-4 md:p-8 lg:p-12">
            <header class="mb-12">
                <h1 class="text-4xl md:text-5xl font-bold text-indigo-900">Traffic & Deployment Strategies</h1>
                <p class="mt-4 text-lg text-stone-600 max-w-4xl">This section focuses on the flow of requests and application updates. Learn about fundamental service discovery, managing traffic into and within the cluster, and compare different deployment strategies to minimize risk and downtime.</p>
            </header>

            <div id="content" class="space-y-16">
                
                <section id="service-discovery">
                    <h2 class="text-3xl font-bold mb-2">Service Discovery</h2>
                    <p class="text-stone-600 mb-6 max-w-3xl">Pods are ephemeral and get new IPs on restart. The Kubernetes `Service` object provides a stable endpoint, and the internal DNS (CoreDNS) makes discovery seamless. This loose coupling is the foundation upon which all other resiliency patterns are built.</p>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                         <div class="flex flex-col md:flex-row items-center gap-6 p-4 bg-stone-50 rounded-lg flex-wrap justify-center">
                             <div class="text-center"><p class="font-mono">Client Pod</p><div class="w-20 h-20 bg-blue-200 rounded-md flex items-center justify-center text-3xl">üíª</div></div>
                             <div class="text-center font-mono text-2xl text-stone-400">‚Üí</div>
                             <div class="text-center"><p class="font-mono">DNS Lookup:</p><code class="text-sm text-indigo-700 bg-indigo-100 p-2 rounded">http://my-service</code></div>
                             <div class="text-center font-mono text-2xl text-stone-400">‚Üí</div>
                             <div class="text-center"><p class="font-mono">K8s Service</p><div class="w-20 h-20 bg-purple-200 rounded-md flex items-center justify-center text-3xl">üéØ</div><p class="font-mono text-sm">Stable IP</p></div>
                             <div class="text-center font-mono text-2xl text-stone-400">‚Üí</div>
                             <div class="text-center"><p class="font-mono">Backend Pods</p><div class="flex gap-2"><div class="w-16 h-16 bg-green-200 rounded-md flex items-center justify-center text-2xl">üì¶</div><div class="w-16 h-16 bg-green-200 rounded-md flex items-center justify-center text-2xl">üì¶</div><div class="w-16 h-16 bg-red-200 rounded-md flex items-center justify-center text-2xl">‚ò†Ô∏è</div></div><p class="font-mono text-sm">Ephemeral IPs</p></div>
                         </div>
                    </div>
                </section>

                <section id="traffic-flow">
                    <h2 class="text-3xl font-bold mb-2">Traffic Flow Management</h2>
                    <p class="text-stone-600 mb-6 max-w-3xl">Managing how traffic enters the cluster (North-South) and moves between services (East-West) is critical for security and reliability. The new <span class="font-semibold">Gateway API</span> is succeeding Ingress for North-South traffic, and a Service Mesh is the standard for East-West.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-lg"><h3 class="font-semibold text-lg mb-4">North-South (Ingress/Egress)</h3><p class="text-sm text-stone-600 mb-4">Managed by an API Gateway or Ingress Controller. The Gateway API provides a powerful, portable, and role-oriented standard for routing external traffic to internal services.</p><div class="font-mono text-xs p-4 bg-stone-100 rounded-md">User ‚Üí Internet ‚Üí <span class="font-bold text-indigo-600">[API Gateway]</span> ‚Üí Service</div></div>
                        <div class="bg-white p-6 rounded-lg shadow-lg"><h3 class="font-semibold text-lg mb-4">East-West (Internal)</h3><p class="text-sm text-stone-600 mb-4">Managed by a Service Mesh (e.g., Istio, Linkerd). The mesh provides mTLS security, observability, and fine-grained traffic control (retries, circuit breakers) for service-to-service communication.</p><div class="font-mono text-xs p-4 bg-stone-100 rounded-md">Service A ‚Üí <span class="font-bold text-purple-600">[Service Mesh Sidecar]</span> ‚Üí Service B</div></div>
                    </div>
                </section>

                <section id="deployment">
                    <h2 class="text-3xl font-bold mb-2">Deployment Strategies</h2>
                    <p class="text-stone-600 mb-6 max-w-3xl">The way you update applications is a critical part of your resiliency strategy. Choosing the right approach involves trade-offs between risk, cost, and speed. Select strategies below to compare them visually on the radar chart.</p>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="md:col-span-1"><h3 class="font-semibold text-lg mb-4">Choose Strategies:</h3><div class="space-y-2" id="strategy-selector"><div><input type="checkbox" id="strat-rolling" value="rolling" class="hidden strategy-checkbox" checked><label for="strat-rolling" class="block p-3 border rounded-md cursor-pointer transition-all">Rolling Update</label></div><div><input type="checkbox" id="strat-bluegreen" value="bluegreen" class="hidden strategy-checkbox" checked><label for="strat-bluegreen" class="block p-3 border rounded-md cursor-pointer transition-all">Blue/Green</label></div><div><input type="checkbox" id="strat-canary" value="canary" class="hidden strategy-checkbox" checked><label for="strat-canary" class="block p-3 border rounded-md cursor-pointer transition-all">Canary</label></div></div></div>
                            <div class="md:col-span-2 chart-container"><canvas id="deploymentChart"></canvas></div>
                        </div>
                    </div>
                </section>
                
                <section id="rate-limiting">
                    <h2 class="text-3xl font-bold mb-2">Rate Limiting & Throttling</h2>
                    <p class="text-stone-600 mb-6 max-w-3xl">Rate limiting acts as a programmatic bulkhead at the network edge, protecting your services from being overwhelmed by traffic spikes. It's a critical resiliency pattern that prevents resource exhaustion and cascading failures.</p>
                     <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-lg"><h3 class="font-semibold text-lg mb-4">Rate Limiting</h3><p class="text-sm text-stone-600">A hard cap on requests. If the limit is exceeded, subsequent requests are rejected (e.g., HTTP 429). Its goal is to enforce usage policies and prevent abuse.</p></div>
                        <div class="bg-white p-6 rounded-lg shadow-lg"><h3 class="font-semibold text-lg mb-4">Throttling</h3><p class="text-sm text-stone-600">A dynamic technique to regulate request flow. It slows down or queues requests to prevent overwhelming the system, smoothing out bursts to maintain availability.</p></div>
                    </div>
                </section>
                
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    if (document.getElementById('deploymentChart')) {
        const deploymentStrategyData = {
            labels: ['Low Risk', 'Low Cost', 'High Speed', 'Fast Rollback', 'Low Complexity'],
            datasets: [
                { label: 'Rolling Update', data: [3, 5, 2, 2, 5], backgroundColor: 'rgba(59, 130, 246, 0.2)', borderColor: 'rgb(59, 130, 246)', pointBackgroundColor: 'rgb(59, 130, 246)' },
                { label: 'Blue/Green', data: [2, 1, 5, 5, 3], backgroundColor: 'rgba(34, 197, 94, 0.2)', borderColor: 'rgb(34, 197, 94)', pointBackgroundColor: 'rgb(34, 197, 94)' },
                { label: 'Canary', data: [5, 4, 1, 5, 1], backgroundColor: 'rgba(249, 115, 22, 0.2)', borderColor: 'rgb(249, 115, 22)', pointBackgroundColor: 'rgb(249, 115, 22)' }
            ]
        };
        const strategyNameMapping = { 'rolling': 'Rolling Update', 'bluegreen': 'Blue/Green', 'canary': 'Canary' };
        let deploymentChart;

        function createDeploymentChart() {
            const ctx = document.getElementById('deploymentChart').getContext('2d');
            deploymentChart = new Chart(ctx, {
                type: 'radar', data: { labels: deploymentStrategyData.labels, datasets: [] },
                options: {
                    maintainAspectRatio: false,
                    scales: { r: { angleLines: { color: 'rgba(0, 0, 0, 0.1)' }, grid: { color: 'rgba(0, 0, 0, 0.1)' }, pointLabels: { font: { size: 12 } }, suggestedMin: 0, suggestedMax: 5, ticks: { stepSize: 1, backdropColor: 'transparent' } } },
                    plugins: { legend: { position: 'top' } }
                }
            });
            updateDeploymentChart();
        }
        
        function updateDeploymentChart() {
            const selectedStrategies = Array.from(document.querySelectorAll('#strategy-selector input:checked')).map(input => strategyNameMapping[input.value]);
            deploymentChart.data.datasets = deploymentStrategyData.datasets.filter(d => selectedStrategies.includes(d.label));
            deploymentChart.update();
        }

        document.getElementById('strategy-selector').addEventListener('change', updateDeploymentChart);
        createDeploymentChart();
    }
});
</script>

</body>
</html>
